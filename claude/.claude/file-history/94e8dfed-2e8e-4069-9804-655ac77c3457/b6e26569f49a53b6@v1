# WindowSnap

一个 macOS 后台工具，通过快捷键 Ctrl+Option+Z 将当前窗口调整到预设位置和大小。

## 功能

- 后台运行，无界面干扰
- 快捷键: Ctrl+Option+Z
- 可自定义窗口位置和大小百分比
- 体积小巧，内存占用极低

## 系统要求

- macOS 10.13 或更高版本
- 辅助功能权限（用于控制其他应用的窗口）
- 辅助功能权限（用于全局快捷键监听）

## 安装与使用

### 方法一：直接构建

1. 克隆或下载此项目
2. 打开终端，进入项目目录
3. 运行构建脚本：
   ```bash
   ./build.sh
   ```
4. 将生成的 `WindowSnap.app` 拖到“应用程序”文件夹
5. 首次运行时，需要授予辅助功能权限：
   - 打开“系统偏好设置” > “安全性与隐私” > “隐私” > “辅助功能”
   - 点击锁定图标并输入密码
   - 添加 `WindowSnap.app` 到列表并勾选
6. 将应用添加到登录项以实现开机自启：
   - “系统偏好设置” > “用户与群组” > “登录项”
   - 添加 `WindowSnap.app`

### 方法二：手动构建

```bash
cd WindowSnap
swift build --configuration release
mkdir -p WindowSnap.app/Contents/MacOS
cp .build/release/WindowSnap WindowSnap.app/Contents/MacOS/
# 创建 Info.plist 和复制配置文件（参考 build.sh）
```

## 配置

编辑 `Resources/config.plist` 文件，设置以下参数（0.0 到 1.0 之间的浮点数）：

- `xPercent`: 窗口左上角横坐标相对于屏幕宽度的百分比
- `yPercent`: 窗口左上角纵坐标相对于屏幕高度的百分比
- `widthPercent`: 窗口宽度相对于屏幕宽度的百分比
- `heightPercent`: 窗口高度相对于屏幕高度的百分比

示例配置（默认）：
```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
    <key>xPercent</key>
    <real>0.25</real>
    <key>yPercent</key>
    <real>0.25</real>
    <key>widthPercent</key>
    <real>0.5</real>
    <key>heightPercent</key>
    <real>0.5</real>
</dict>
</plist>
```

修改配置后，需要重启应用生效。

## 工作原理

1. 使用 Core Graphics 事件监听全局快捷键
2. 通过 Accessibility API 获取当前活动窗口
3. 根据配置计算目标位置和大小
4. 调整窗口位置和尺寸

## 常见问题

### 快捷键无效
- 检查是否已授予辅助功能权限
- 检查是否有其他应用占用了相同的快捷键
- 重启应用或重新登录系统

### 窗口无法调整
- 某些应用（如系统应用）可能限制窗口操作
- 确保目标应用支持 Accessibility API

### 应用无法启动
- 确保系统版本符合要求
- 尝试重新构建应用

## 卸载

1. 退出 WindowSnap 应用
2. 从“应用程序”文件夹删除 `WindowSnap.app`
3. 从登录项中移除
4. 从辅助功能权限列表中移除

## 源代码结构

- `Sources/main.swift` - 主程序代码
- `Resources/config.plist` - 配置文件
- `Package.swift` - Swift 包配置文件
- `build.sh` - 构建脚本

## 许可证

MIT License